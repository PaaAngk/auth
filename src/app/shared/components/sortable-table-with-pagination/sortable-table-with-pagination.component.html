<!-- <p
    tuiTextfieldSize="m"
    class=" flex"
>
    <tui-input
        class="input"
        [tuiTextfieldCleaner]="true"
        [(ngModel)]="search"
    >
        Find on page
    </tui-input>
    <tui-input-count
        class="tui-space_horizontal-3"
        [formControl]="minAge"
    >
        Minimum age
    </tui-input-count>
    <tui-hosted-dropdown [content]="dropdown">
        <button
            tuiButton
            size="m"
            [iconRight]="arrow"
        >
            Columns
        </button>
        <ng-template #dropdown>
            <tui-reorder
                class="columns"
                [enabled]="enabled"
                [(items)]="initial"
                (enabledChange)="onEnabled($event)"
            ></tui-reorder>
        </ng-template>
    </tui-hosted-dropdown>
</p> -->
<tui-loader
    [overlay]="true"
    [showLoader]="!!(loading$ | async)"
>
    <table
        *tuiLet="data$ | async as data"
        tuiTable
        class="w-full h-full my-4"
        [columns]="columns"
        [direction]="(direction$ | async) || 1"
        [tuiSortBy]="sorter$ | async"
        (tuiSortByChange)="sorter$.next($event!)"
        (directionChange)="direction$.next($event)"
    >
        <thead>
            <tr tuiThGroup>
                <ng-container 
                    *ngFor="let key of KEYS | keyvalue"
                >
                <!-- {{key.value}} -- {{key.key}} -->
                    <th
                        *tuiHead="key.value"
                        tuiTh
                        tuiSortable
                    >
                        {{key.key}}
                    </th>
                </ng-container>
            </tr>
        </thead>
        <tbody
            tuiTbody
            [data]="data"
        >
            <tr
                *tuiRow="let item of data"
                tuiTr
            >
                <ng-container 
                    *ngFor="let key of KEYS | keyvalue"
                >
                    <td
                        *tuiCell="key.value"
                        tuiTd
                        [class.table-search-select]="isMatch(item.name)"
                    >
                        {{ getTableCellByKey(item, key.value ) }}
                    </td>
                </ng-container>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <td [colSpan]="columns.length">
                    <tui-table-pagination
                        class="tui-space_top-2"
                        [total]="(total$ | async) || 0"
                        (pageChange)="onPage($event)"
                        (sizeChange)="onSize($event)"
                    ></tui-table-pagination>
                </td>
            </tr>
        </tfoot>
    </table>
</tui-loader>

